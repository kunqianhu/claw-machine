<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Realistic Emoji Claw Machine</title>
<style>
body {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  flex-direction: column;
  background: #f0f8ff;
  font-family: sans-serif;
  height: 100vh;
  padding-top: 20px;
}

.machine {
  width: 350px;
  height: 400px;
  border: 5px solid #555;
  border-radius: 10px;
  position: relative;
  background: #dfefff;
  overflow: hidden;
  margin-bottom: 20px;
}

.claw {
  position: absolute;
  top: 0;
  left: 140px;
  width: 60px;
  height: 100px;
}

.arm {
  position: absolute;
  width: 10px;
  height: 50px;
  background: #888;
  top: 0;
  transform-origin: top center;
  transition: transform 0.3s;
}

.arm.left {
  left: 0;
  transform: rotate(-30deg);
}

.arm.right {
  right: 0;
  transform: rotate(30deg);
}

.claw-grab {
  position: absolute;
  width: 60px;
  height: 20px;
  background: #888;
  bottom: 0;
  border-radius: 5px;
}

.prizes {
  position: absolute;
  bottom: 0;
  width: 100%;
  font-size: 2em;
}

.prize {
  position: absolute;
  transition: top 0.5s, left 0.5s;
}

.controls {
  margin-bottom: 10px;
}

button {
  margin: 0 5px;
  padding: 10px 15px;
  font-size: 1em;
  cursor: pointer;
  border-radius: 5px;
  border: 2px solid #555;
  background: #fff;
  transition: background 0.3s;
}

button:hover {
  background: #e0f0ff;
}

.fortune {
  display: flex;
  gap: 5px;
  font-size: 2em;
  min-height: 2em;
  justify-content: flex-start;
}
</style>
</head>
<body>

<div class="machine" id="machine">
  <div class="claw" id="claw">
    <div class="arm left"></div>
    <div class="arm right"></div>
    <div class="claw-grab"></div>
  </div>
</div>

<div class="controls">
  <button id="leftBtn">‚Üê</button>
  <button id="grabBtn">Grab</button>
  <button id="rightBtn">‚Üí</button>
</div>

<div class="fortune" id="fortune"></div>

<script>
const machine = document.getElementById('machine');
const claw = document.getElementById('claw');
const leftArm = claw.querySelector('.arm.left');
const rightArm = claw.querySelector('.arm.right');
const leftBtn = document.getElementById('leftBtn');
const rightBtn = document.getElementById('rightBtn');
const grabBtn = document.getElementById('grabBtn');
const fortune = document.getElementById('fortune');

const columns = 5;
const prizes = ['üç©','üç™','üçì','üçâ','üç¨','üç´','üçí','üçï','üç¶','ü•ï'];
const prizeElements = [];
let clawPos = 2; // start at middle column

// Randomly stacked prizes
const stackPrizes = () => {
  for(let i=0;i<columns;i++){
    let stackCount = Math.floor(Math.random() * 4) + 2; // 2-5 per column
    for(let j=0;j<stackCount;j++){
      let prize = document.createElement('span');
      prize.className = 'prize';
      prize.textContent = prizes[Math.floor(Math.random()*prizes.length)];
      machine.appendChild(prize);
      let left = 40 + i*60 + Math.random()*10 - 5;
      let top = 300 - j*50 + Math.random()*10 - 5;
      prize.style.left = left+'px';
      prize.style.top = top+'px';
      prizeElements.push({el:prize, col:i, top:top});
    }
  }
};
stackPrizes();

// Move claw
const moveClaw = (dir) => {
  clawPos = Math.min(Math.max(clawPos + dir,0),columns-1);
  let left = 40 + clawPos*60;
  claw.style.left = left+'px';
};

leftBtn.addEventListener('click',()=>moveClaw(-1));
rightBtn.addEventListener('click',()=>moveClaw(1));

const sleep = ms => new Promise(r=>setTimeout(r, ms));

grabBtn.addEventListener('click', async ()=>{
  // Find top prize in claw column
  let columnPrizes = prizeElements.filter(p=>p.col===clawPos && p.top > 0);
  columnPrizes.sort((a,b)=>a.top-b.top);
  if(columnPrizes.length===0) return;
  let prize = columnPrizes[0];

  // Move claw down
  claw.style.transition = 'top 0.7s';
  claw.style.top = (prize.top - 20)+'px';
  await sleep(700);

  // Close claw arms
  leftArm.style.transform = 'rotate(-10deg)';
  rightArm.style.transform = 'rotate(10deg)';
  await sleep(300);

  // Attempt grab 70%
  let success = Math.random() < 0.7;
  if(success){
    // Move prize with claw
    prize.el.style.transition = 'top 0.7s, left 0.7s';
    prize.el.style.top = (claw.offsetTop + 80)+'px';
    prize.el.style.left = claw.offsetLeft + 5 +'px';
    
    // Lift claw
    claw.style.top = '0px';
    await sleep(700);

    // Move to bottom storage
    let dropX = 20 + fortune.childElementCount*40;
    claw.style.left = dropX+'px';
    await sleep(700);

    // 80% chance keep prize
    let keep = Math.random() < 0.8;
    if(keep){
      prize.el.style.transition = 'top 0.5s, left 0.5s';
      prize.el.style.top = '0px';
      prize.el.style.left = '0px';
      fortune.appendChild(prize.el);
      prizeElements.splice(prizeElements.indexOf(prize),1);
    } else {
      // Dropped before delivery
      prize.el.style.top = (prize.top + 50)+'px';
      prize.el.style.left = prize.el.offsetLeft +'px';
      await sleep(500);
    }

  }

  // Open claw arms
  leftArm.style.transform = 'rotate(-30deg)';
  rightArm.style.transform = 'rotate(30deg)';
  await sleep(300);

  // Return claw to column
  claw.style.left = 40 + clawPos*60 +'px';
});
</script>

</body>
</html>
